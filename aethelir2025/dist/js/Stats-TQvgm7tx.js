import{f as w,c as ee,j as e,D as te,P as se}from"./index-BSdoB3kj.js";import{R as ae,r}from"./chart-vendor-Dw_LCnh4.js";import{K as le,E as $,N as re,d as ne,b as ie,S as oe,c as ce,O as de,Q as xe,x as me,T as H,R as he,L as ue,p as fe,U as pe,A as ge,V as ve}from"./icon-vendor-CFCYlFMW.js";import"./react-vendor-B--z-fyW.js";const F=({trades:b,changeTab:V})=>{const[p,W]=r.useState("all"),[n,y]=r.useState([]),[c,z]=r.useState(["net","avg","winrate","pf","roi","total","hold"]),[j,U]=r.useState(!1),[d,S]=r.useState(null),[C,B]=r.useState("all"),[N,k]=r.useState("line"),[x,g]=r.useState("default"),[T,L]=r.useState(!1),[D,G]=r.useState("#000000"),[v,A]=r.useState("net"),m=r.useMemo(()=>p==="all"?b:b.filter(t=>(t.style||"Intraday")===p),[b,p]),h=r.useMemo(()=>{const t=m,a=t.reduce((s,o)=>s+o.pnl,0),l=t.length>0?a/t.length:0,i=new Set(t.map(s=>s.date.substring(0,7))).size||1,f=(a/i).toFixed(1),P=t.filter(s=>s.pnl>0).reduce((s,o)=>s+o.pnl,0),O=Math.abs(t.filter(s=>s.pnl<0).reduce((s,o)=>s+o.pnl,0)),J=O===0?P.toFixed(2):(P/O).toFixed(2),X=t.filter(s=>s.pnl>0).length,Y=t.length===0?0:Math.round(X/t.length*100),E=[{id:"net",label:"Total Return",icon:"trending-up",desc:"Total cumulative return",value:w(a)},{id:"avg",label:"Avg Return",icon:"percent",desc:"Average PnL per trade",value:w(l)},{id:"winrate",label:"Winrate",icon:"activity",desc:"Percentage of profitable trades",value:Y+"%"},{id:"pf",label:"Profit Factor",icon:"pie-chart",desc:"Ratio of gross profit to gross loss",value:J},{id:"roi",label:"Monthly ROI",icon:"calendar",desc:"Average return per month",value:w(f)},{id:"total",label:"Total Trades",icon:"layers",desc:"Number of executed trades",value:t.length},{id:"hold",label:"Time in Trade",icon:"clock",desc:"Average position duration",value:"4h 12m"}],Z=c.map(s=>E.find(o=>o.id===s)).filter(s=>s!==void 0),_=E.filter(s=>!c.includes(s.id));return[...Z,..._]},[m,c]),I=h.find(t=>t.id===v)||h[0],u=r.useMemo(()=>ee(m),[m]),K=(t,a)=>{S(a),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",a),t.currentTarget instanceof HTMLElement&&t.currentTarget.classList.add("opacity-50","scale-95")},Q=(t,a)=>{if(t.preventDefault(),!d||d===a)return;const l=c.indexOf(d),i=c.indexOf(a);if(l!==-1&&i!==-1){const f=[...c];f.splice(l,1),f.splice(i,0,d),z(f)}},q=t=>{t.currentTarget instanceof HTMLElement&&t.currentTarget.classList.remove("opacity-50","scale-95"),S(null)},R=(t,a)=>{if(a?.stopPropagation(),n.includes(t))y(n.filter(l=>l!==t));else if(y([...n,t]),v===t){const l=h.find(i=>!n.includes(i.id)&&i.id!==t);l&&A(l.id)}},M=t=>{switch(t){case"trending-up":return H;case"percent":return ve;case"activity":return ge;case"pie-chart":return pe;case"calendar":return fe;case"layers":return ue;case"clock":return he;default:return H}};return e.jsxs("div",{className:"space-y-8 flex flex-col h-full",children:[e.jsxs("header",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-light text-slate-800",children:"Advanced Analytics"}),e.jsx("p",{className:"text-slate-400 mt-1",children:"Deep dive into your performance metrics."})]}),e.jsxs("button",{onClick:()=>V("dashboard"),className:"flex items-center gap-2 text-slate-400 hover:text-slate-800 transition mb-1 text-sm font-medium",children:[e.jsx(le,{className:"w-4 h-4"})," Back to Dashboard"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-4 overflow-visible",style:{paddingLeft:"4px",paddingRight:"4px"},children:[e.jsxs("div",{className:"flex items-center justify-between px-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-slate-700 uppercase text-xs tracking-wider",children:"Select Metric"}),e.jsxs("select",{value:p,onChange:t=>W(t.target.value),className:"bg-white border border-slate-200 text-xs font-semibold text-slate-600 rounded-lg px-2 py-1 outline-none hover:border-slate-300 cursor-pointer shadow-sm",children:[e.jsx("option",{value:"all",children:"All Styles"}),e.jsx("option",{value:"Swing",children:"Swing"}),e.jsx("option",{value:"Intraday",children:"Intraday"})]})]}),e.jsxs("div",{className:"space-y-3 overflow-visible",children:[h.filter(t=>!n.includes(t.id)).map(t=>{const a=M(t.icon);return e.jsxs("div",{onClick:()=>A(t.id),draggable:!0,onDragStart:l=>K(l,t.id),onDragOver:l=>Q(l,t.id),onDragEnd:q,className:`soft-card p-4 flex items-center gap-4 cursor-pointer transition-all duration-300 hover:shadow-md group relative ${v===t.id?"ring-2 ring-slate-800 bg-slate-50":"hover:-translate-y-1"} ${d===t.id?"cursor-grabbing":"cursor-grab"}`,style:{marginLeft:"-2px",marginRight:"-2px",paddingLeft:"18px",paddingRight:"18px"},children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold shadow-sm ${v===t.id?"bg-slate-800 text-white":"bg-slate-100 text-slate-500"}`,children:e.jsx(a,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-slate-800 text-sm",children:t.label}),e.jsx("div",{className:"text-xs text-slate-400",children:t.desc})]}),e.jsx("div",{className:"text-sm font-semibold text-slate-700",children:t.value}),e.jsx("button",{onClick:l=>R(t.id,l),className:"absolute -top-2 -right-2 bg-white border border-slate-200 shadow-sm p-1.5 rounded-full text-slate-400 hover:text-rose-500 hover:border-rose-200 opacity-0 group-hover:opacity-100 transition-all duration-200 z-10",title:"Hide metric",children:e.jsx($,{className:"w-3 h-3"})})]},t.id)}),n.length>0&&e.jsxs("div",{className:"pt-6 border-t border-slate-100 animate-fade-in",children:[e.jsxs("button",{onClick:()=>U(!j),className:"flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-wider mb-3 hover:text-slate-600 transition w-full",children:[e.jsx($,{className:"w-3 h-3"}),e.jsx("span",{children:"Hidden Metrics"}),e.jsx("span",{className:"ml-auto",children:j?e.jsx(re,{className:"w-3 h-3"}):e.jsx(ne,{className:"w-3 h-3"})})]}),j&&e.jsx("div",{className:"flex flex-wrap gap-2",children:h.filter(t=>n.includes(t.id)).map(t=>{const a=M(t.icon);return e.jsxs("button",{onClick:()=>R(t.id),className:"flex items-center gap-2 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-xs font-medium text-slate-500 hover:bg-white hover:border-slate-300 hover:text-slate-700 hover:shadow-sm transition group",children:[e.jsx(a,{className:"w-3 h-3 opacity-50"}),e.jsx("span",{children:t.label}),e.jsx(ie,{className:"w-3 h-3 ml-1 text-slate-300 group-hover:text-slate-600"})]},t.id)})})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"soft-card p-6 lg:p-8 flex flex-col",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-700 text-lg",children:I?.label}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Historical Performance"})]}),e.jsxs("div",{className:"flex gap-3 w-full sm:w-auto flex-wrap items-center justify-end",children:[e.jsxs("select",{value:C,onChange:t=>B(t.target.value),className:"custom-select bg-white border border-slate-200 text-slate-600 text-sm rounded-xl px-4 py-2 outline-none hover:border-slate-300 transition cursor-pointer font-medium shadow-sm",style:{minWidth:"140px"},children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"custom",children:"Custom"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>L(!T),className:"p-2 rounded-xl hover:bg-slate-100 text-slate-500 transition border border-transparent hover:border-slate-200",children:e.jsx(oe,{className:"w-5 h-5"})}),T&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>L(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-64 bg-white rounded-2xl shadow-xl border border-slate-100 p-5 z-10 space-y-5 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider block mb-2",children:"Type"}),e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>k("line"),className:`flex-1 py-1.5 text-xs font-semibold rounded-lg transition ${N==="line"?"bg-white shadow-sm text-slate-800":"text-slate-500 hover:text-slate-700"}`,children:"Line"}),e.jsx("button",{onClick:()=>k("bar"),className:`flex-1 py-1.5 text-xs font-semibold rounded-lg transition ${N==="bar"?"bg-white shadow-sm text-slate-800":"text-slate-500 hover:text-slate-700"}`,children:"Bar"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider block mb-2",children:"Color"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>g("default"),className:`px-2 py-1 bg-slate-100 rounded text-[10px] font-bold uppercase text-slate-500 hover:bg-slate-200 transition ${x==="default"?"ring-2 ring-slate-300":""}`,children:"Auto"}),e.jsx("div",{onClick:()=>g("blue"),className:`color-radio bg-blue-500 ${x==="blue"?"active":""}`}),e.jsx("div",{onClick:()=>g("purple"),className:`color-radio bg-violet-500 ${x==="purple"?"active":""}`}),e.jsxs("div",{className:`color-radio flex items-center justify-center bg-slate-100 border border-slate-200 ${x==="custom"?"active ring-2 ring-slate-300":""}`,children:[e.jsx(ce,{className:"w-3 h-3 text-slate-400"}),e.jsx(te,{initialColor:D,onActive:()=>g("custom"),onColorChange:t=>G(t)})]})]})]})]})]})]})]})]}),e.jsx(se,{trades:m,timeframe:C,customStart:"",customEnd:"",chartStyle:N,chartColor:x,customColor:D,selectedStat:I,isDetailed:!0})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8",children:[e.jsxs("div",{className:"soft-card p-6 flex flex-col justify-between h-40 group hover:border-rose-200 transition",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-slate-400 text-sm font-medium",children:"Max Drawdown"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 group-hover:bg-rose-50 group-hover:text-rose-500 transition",children:e.jsx(de,{className:"w-4 h-4"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-3xl font-light text-slate-800",children:u.dd}),e.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"Peak to Valley"})]})]}),e.jsxs("div",{className:"soft-card p-6 flex flex-col justify-between h-40 group hover:border-green-200 transition",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-slate-400 text-sm font-medium",children:"Max Win Streak"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 group-hover:bg-green-50 group-hover:text-green-600 transition",children:e.jsx(xe,{className:"w-4 h-4"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-light text-slate-800",children:u.maxWinStreak}),e.jsx("span",{className:"text-sm text-slate-400 font-medium",children:"Trades"})]}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Total Gain: ",e.jsx("span",{className:"font-semibold text-green-600",children:u.maxWinStreakVal})]})]})]}),e.jsxs("div",{className:"soft-card p-6 flex flex-col justify-between h-40 group hover:border-orange-200 transition",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-slate-400 text-sm font-medium",children:"Max Loss Streak"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 group-hover:bg-orange-50 group-hover:text-orange-500 transition",children:e.jsx(me,{className:"w-4 h-4"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-light text-slate-800",children:u.maxLossStreak}),e.jsx("span",{className:"text-sm text-slate-400 font-medium",children:"Trades"})]}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Total Loss: ",e.jsx("span",{className:"font-semibold text-rose-500",children:u.maxLossStreakVal})]})]})]})]})]})};F.displayName="Stats";const ye=ae.memo(F);export{ye as Stats};
